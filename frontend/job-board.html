<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Board - LocumTrueRate</title>
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="js/common-utils.css">
    <script src="js/apiClient.js"></script>
    <script src="js/common-utils.js"></script>
    <style>
        /* Using centralized CSS variables from css/variables.css */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1rem;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--background-color);
        }

        /* Navigation */
        .navbar {
            background-color: var(--surface-color);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-brand h2 {
            color: var(--primary-color);
            font-weight: 700;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-link {
            text-decoration: none;
            color: var(--text-primary);
            font-weight: 500;
            transition: color 0.2s;
            position: relative;
        }

        .nav-link:hover {
            color: var(--primary-color);
        }

        .nav-link.active {
            color: var(--primary-color);
        }

        /* Layout */
        .page-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex: 1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .section {
            margin-bottom: 4rem;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .hero h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        /* Job Board Content */
        .job-board-content {
            padding: 3rem 0;
        }

        /* Jobs Grid */
        .jobs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        /* Job Card */
        .job-card {
            background-color: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .job-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
        }
        
        .job-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 1rem;
        }
        
        .job-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }
        
        .job-facility {
            color: var(--primary-color);
            font-weight: 500;
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }
        
        .job-location {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .job-details {
            color: var(--text-secondary);
            margin: 0.5rem 0;
            font-size: 0.95rem;
        }
        
        .job-salary {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--success-color);
            margin: 0;
        }
        
        .job-meta {
            display: flex;
            gap: 1.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .job-meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Filters Section */
        .filters-section {
            background-color: var(--surface-color);
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .filters-grid {
            display: grid;
            grid-template-columns: 2fr repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .results-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-secondary);
        }
        
        #resultsCount {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.1rem;
        }
        
        /* Form Controls */
        .form-control {
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            font-size: 1rem;
            background-color: var(--background-color);
            color: var(--text-primary);
            transition: border-color 0.2s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.1);
        }
        
        /* Job Details Modal Styles */
        .job-details h3 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }
        
        .job-details .job-location {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }
        
        .job-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1rem;
            background-color: var(--background-color);
            border-radius: 0.5rem;
        }
        
        .job-info-item {
            font-size: 0.95rem;
        }
        
        .job-details h4 {
            color: var(--text-primary);
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
        }
        
        .job-details ul {
            margin-left: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .job-details ul li {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        /* Footer */
        .footer {
            background-color: var(--surface-color);
            border-top: 1px solid var(--border-color);
            padding: 4rem 0 2rem;
            margin-top: 6rem;
        }

        .footer-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .footer-section h4,
        .footer-section h5 {
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section li {
            margin-bottom: 0.5rem;
        }

        .footer-section a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.2s;
        }

        .footer-section a:hover {
            color: var(--primary-color);
        }

        .social-icons {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-icon {
            color: var(--text-secondary);
            transition: color 0.2s;
        }

        .social-icon:hover {
            color: var(--primary-color);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
            color: var(--text-secondary);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .nav-menu {
                flex-direction: column;
                gap: 1rem;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .jobs-grid {
                grid-template-columns: 1fr;
            }
            
            .filters-grid {
                grid-template-columns: 1fr;
            }
            
            .job-header {
                flex-direction: column;
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <!-- Navigation -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-brand">
                    <h2>LocumTrueRate</h2>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html" class="nav-link">Home</a></li>
                    <li><a href="job-board.html" class="nav-link active">Job Board</a></li>
                    <li><a href="locum-dashboard.html" class="nav-link">Locum Dashboard</a></li>
                    <li><a href="recruiter-dashboard.html" class="nav-link">Recruiter Portal</a></li>
                    <li><a href="admin-dashboard.html" class="nav-link">Admin</a></li>
                </ul>
            </div>
        </nav>

        <main class="main-content">
            <!-- Hero Section -->
            <section class="hero">
                <div class="container">
                    <h1>Find Your Perfect Locum Position</h1>
                    <p>Browse thousands of locum tenens opportunities tailored to your specialty and preferences</p>
                </div>
            </section>

            <!-- Job Board Content -->
            <section class="job-board-content">
                <div class="container">
                    <!-- Filters -->
                    <div class="filters-section">
                        <div class="filters-grid">
                            <input type="text" id="searchInput" placeholder="Search by title or location..." class="form-control">
                            
                            <select id="specialtyFilter" class="form-control">
                                <option value="">All Specialties</option>
                                <option value="emergency">Emergency Medicine</option>
                                <option value="internal">Internal Medicine</option>
                                <option value="family">Family Medicine</option>
                                <option value="pediatrics">Pediatrics</option>
                                <option value="surgery">Surgery</option>
                            </select>
                            
                            <select id="locationFilter" class="form-control">
                                <option value="">All Locations</option>
                                <option value="CA">California</option>
                                <option value="TX">Texas</option>
                                <option value="FL">Florida</option>
                                <option value="NY">New York</option>
                                <option value="CO">Colorado</option>
                            </select>
                            
                            <select id="sortFilter" class="form-control">
                                <option value="">Sort By</option>
                                <option value="salary-high">Salary: High to Low</option>
                                <option value="salary-low">Salary: Low to High</option>
                                <option value="date">Most Recent</option>
                            </select>
                        </div>
                        
                        <div class="results-info">
                            <span><span id="resultsCount">0</span> positions found</span>
                        </div>
                    </div>
                    
                    <!-- Jobs Grid -->
                    <div class="jobs-grid" id="jobsGrid">
                        <!-- Jobs will be dynamically loaded here -->
                    </div>
                </div>
            </section>
        </main>
        
        <!-- Job Detail Modal -->
        <div id="jobModal" class="modal-backdrop" style="display: none;" role="dialog" aria-labelledby="jobModalTitle" aria-modal="true" aria-hidden="true">
            <div class="modal" role="document">
                <div class="modal-header">
                    <h2 id="jobModalTitle" class="modal-title">Job Details</h2>
                    <button type="button" class="modal-close" id="modalCloseBtn" aria-label="Close modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="modalContent">
                    <!-- Job details will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="footer-container">
                    <div class="footer-section">
                        <h4>LocumTrueRate</h4>
                        <p>Empowering healthcare professionals with accurate contract analysis and job matching.</p>
                    </div>
                    <div class="footer-section">
                        <h5>Tools</h5>
                        <ul>
                            <li><a href="paycheck-calculator.html">Paycheck Calculator</a></li>
                            <li><a href="contract-calculator.html">Contract Calculator</a></li>
                            <li><a href="job-board.html">Job Board</a></li>
                        </ul>
                    </div>
                    <div class="footer-section">
                        <h5>Support</h5>
                        <ul>
                            <li><a href="#">Help Center</a></li>
                            <li><a href="#">Contact Us</a></li>
                            <li><a href="#">Privacy Policy</a></li>
                        </ul>
                    </div>
                    <div class="footer-section">
                        <h5>Contact</h5>
                        <div class="contact-info">
                            <p><a href="mailto:support@locumtruerate.com">support@locumtruerate.com</a></p>
                        </div>
                        <div class="social-icons">
                            <a href="https://linkedin.com/company/locumtruerate" class="social-icon" aria-label="LinkedIn">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                                </svg>
                            </a>
                            <a href="https://twitter.com/locumtruerate" class="social-icon" aria-label="Twitter">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>&copy; 2025 LocumTrueRate. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Simple, clean job board implementation
        const jobBoard = {
            jobs: [],
            filteredJobs: [],
            
            async init() {
                this.jobs = await this.loadJobs();
                this.filteredJobs = [...this.jobs];
                this.render();
                this.attachListeners();
            },
            
            async loadJobs() {
                try {
                    const apiUrl = window.location.hostname === 'localhost' 
                        ? 'http://localhost:4000/api/v1/jobs'
                        : window.location.origin + '/api/v1/jobs';
                    
                    const response = await fetch(apiUrl);
                    const data = await response.json();
                    
                    if (data.success && data.jobs) {
                        return data.jobs.map(job => this.transformJob(job));
                    }
                } catch (error) {
                    // Silent fallback to default jobs
                }
                
                return this.getDefaultJobs();
            },
            
            transformJob(apiJob) {
                return {
                    id: apiJob.id,
                    title: apiJob.title,
                    facility: apiJob.hospital_name,
                    location: `${apiJob.city}, ${apiJob.state}`,
                    state: apiJob.state,
                    specialty: apiJob.specialty?.toLowerCase(),
                    salary: `$${apiJob.hourly_rate}/hr`,
                    hourlyRate: apiJob.hourly_rate,
                    duration: `${apiJob.contract_length} weeks`,
                    hours: `${apiJob.weekly_hours} hrs/week`,
                    housing: apiJob.housing_provided ? 'Housing included' : 'No housing',
                    description: apiJob.description || 'Great opportunity for locum physician.',
                    requirements: apiJob.requirements || ['Active medical license', 'Board certification']
                };
            },
            
            getDefaultJobs() {
                return [
                    {
                        id: 1,
                        title: 'Emergency Medicine Physician',
                        facility: 'Metropolitan General Hospital',
                        location: 'Los Angeles, CA',
                        state: 'CA',
                        specialty: 'emergency',
                        salary: '$350/hr',
                        hourlyRate: 350,
                        duration: '13 weeks',
                        hours: '48 hrs/week',
                        housing: 'Housing included',
                        description: 'Join our busy Level 1 trauma center.',
                        requirements: ['Board Certified EM', 'ACLS/PALS Required']
                    },
                    {
                        id: 2,
                        title: 'Internal Medicine Hospitalist',
                        facility: 'Houston Medical Center',
                        location: 'Houston, TX',
                        state: 'TX',
                        specialty: 'internal',
                        salary: '$300/hr',
                        hourlyRate: 300,
                        duration: '26 weeks',
                        hours: '50 hrs/week',
                        housing: 'Housing included',
                        description: 'Seeking experienced hospitalist for busy medical center.',
                        requirements: ['Board Certified IM', '3+ Years Experience']
                    },
                    {
                        id: 3,
                        title: 'Family Medicine Provider',
                        facility: 'Rocky Mountain Clinic',
                        location: 'Denver, CO',
                        state: 'CO',
                        specialty: 'family',
                        salary: '$275/hr',
                        hourlyRate: 275,
                        duration: '13 weeks',
                        hours: '40 hrs/week',
                        housing: 'No housing',
                        description: 'Beautiful clinic in Denver metro area.',
                        requirements: ['Board Certified FM', 'DEA License']
                    }
                ];
            },
            
            render() {
                const grid = document.getElementById('jobsGrid');
                const count = document.getElementById('resultsCount');
                
                count.textContent = this.filteredJobs.length;
                
                if (this.filteredJobs.length === 0) {
                    grid.innerHTML = '<p style="text-align: center; color: var(--text-secondary);">No jobs found. Try adjusting your filters.</p>';
                    return;
                }
                
                grid.innerHTML = this.filteredJobs.map(job => `
                    <div class="job-card" data-job-id="${job.id}">
                        <div class="job-header">
                            <div>
                                <h3 class="job-title">${job.title}</h3>
                                <p class="job-facility">${job.facility}</p>
                                <p class="job-location">📍 ${job.location}</p>
                            </div>
                            <div>
                                <p class="job-salary">${job.salary}</p>
                            </div>
                        </div>
                        <div class="job-meta">
                            <div class="job-meta-item">⏱️ ${job.duration}</div>
                            <div class="job-meta-item">🕐 ${job.hours}</div>
                            <div class="job-meta-item">🏠 ${job.housing}</div>
                        </div>
                    </div>
                `).join('');
                
                // Add click listeners to job cards
                document.querySelectorAll('.job-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const jobId = parseInt(card.dataset.jobId);
                        this.showJob(jobId);
                    });
                });
            },
            
            filter() {
                const search = document.getElementById('searchInput').value.toLowerCase();
                const specialty = document.getElementById('specialtyFilter').value;
                const location = document.getElementById('locationFilter').value;
                
                this.filteredJobs = this.jobs.filter(job => {
                    const matchesSearch = !search || 
                        job.title.toLowerCase().includes(search) ||
                        job.location.toLowerCase().includes(search);
                    
                    const matchesSpecialty = !specialty || job.specialty === specialty;
                    const matchesLocation = !location || job.state === location;
                    
                    return matchesSearch && matchesSpecialty && matchesLocation;
                });
                
                this.sort();
                this.render();
            },
            
            sort() {
                const sortBy = document.getElementById('sortFilter').value;
                
                if (sortBy === 'salary-high') {
                    this.filteredJobs.sort((a, b) => b.hourlyRate - a.hourlyRate);
                } else if (sortBy === 'salary-low') {
                    this.filteredJobs.sort((a, b) => a.hourlyRate - b.hourlyRate);
                } else if (sortBy === 'date') {
                    this.filteredJobs.sort((a, b) => b.id - a.id);
                }
            },
            
            showJob(id) {
                const job = this.jobs.find(j => j.id === id);
                if (!job) return;
                
                const modal = document.getElementById('jobModal');
                const title = document.getElementById('jobModalTitle');
                const content = document.getElementById('modalContent');
                
                // Update modal title
                title.textContent = job.title;
                
                content.innerHTML = `
                    <div class="job-details">
                        <h3>${job.facility}</h3>
                        <p class="job-location">📍 ${job.location}</p>
                        
                        <div class="job-info-grid">
                            <div class="job-info-item">
                                <strong>Salary:</strong> ${job.salary}
                            </div>
                            <div class="job-info-item">
                                <strong>Duration:</strong> ${job.duration}
                            </div>
                            <div class="job-info-item">
                                <strong>Hours:</strong> ${job.hours}
                            </div>
                            <div class="job-info-item">
                                <strong>Housing:</strong> ${job.housing}
                            </div>
                        </div>
                        
                        <h4>Description</h4>
                        <p>${job.description}</p>
                        
                        <h4>Requirements</h4>
                        <ul>
                            ${job.requirements.map(req => `<li>${req}</li>`).join('')}
                        </ul>
                        
                        <button class="btn btn-primary" id="applyBtn">Apply Now</button>
                    </div>
                `;
                
                // Show modal
                modal.style.display = 'flex';
                modal.setAttribute('aria-hidden', 'false');
                document.body.style.overflow = 'hidden';
                
                // Add event listener for Apply button
                document.getElementById('applyBtn').addEventListener('click', () => {
                    // Close the job modal first
                    this.closeModal();
                    
                    // Show the register modal
                    if (window.LocumUtils && typeof window.LocumUtils.showRegisterModal === 'function') {
                        window.LocumUtils.showRegisterModal();
                    } else {
                        // Fallback if LocumUtils not loaded
                        console.error('LocumUtils.showRegisterModal not available');
                        if (window.showToast) {
                            showToast('Please sign up to apply for positions', 'info');
                        }
                    }
                });
            },
            
            closeModal() {
                const modal = document.getElementById('jobModal');
                modal.style.display = 'none';
                modal.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = '';
            },
            
            attachListeners() {
                document.getElementById('searchInput').addEventListener('input', () => this.filter());
                document.getElementById('specialtyFilter').addEventListener('change', () => this.filter());
                document.getElementById('locationFilter').addEventListener('change', () => this.filter());
                document.getElementById('sortFilter').addEventListener('change', () => this.filter());
                
                // Close modal on backdrop click
                document.getElementById('jobModal').addEventListener('click', (e) => {
                    if (e.target.id === 'jobModal' || e.target.classList.contains('modal-backdrop')) {
                        this.closeModal();
                    }
                });
                
                // Close modal on close button click
                document.getElementById('modalCloseBtn').addEventListener('click', () => {
                    this.closeModal();
                });
                
                // Close modal on ESC key
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && document.getElementById('jobModal').style.display !== 'none') {
                        this.closeModal();
                    }
                });
            }
        };
        
        // Single initialization
        document.addEventListener('DOMContentLoaded', () => jobBoard.init());
    </script>
</body>
</html>