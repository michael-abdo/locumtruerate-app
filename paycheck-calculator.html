<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paycheck Calculator - LocumTrueRate</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f4f4f4;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .navbar {
            background-color: #fff;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2563eb;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
        }

        .calculator-container {
            background-color: #fff;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2563eb;
            margin-bottom: 2rem;
            text-align: center;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .input-section, .results-section {
            background-color: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #2563eb;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 0.25rem;
            font-weight: 500;
            color: #555;
        }

        input[type="number"],
        select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .period-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .period-tab {
            flex: 1;
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background-color: #fff;
            cursor: pointer;
            border-radius: 4px;
            transition: all 0.3s;
        }

        .period-tab.active {
            background-color: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .result-label {
            color: #555;
        }

        .result-value {
            font-weight: bold;
            color: #333;
        }

        .result-total {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid #2563eb;
            font-size: 1.25rem;
        }

        .result-total .result-value {
            color: #2563eb;
        }

        .button-group {
            margin-top: 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: #2563eb;
            color: white;
        }

        .btn-primary:hover {
            background-color: #1d4ed8;
        }

        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #5a6268;
        }

        .error-message {
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.25rem;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 4px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        .toast.success {
            background-color: #28a745;
        }

        .toast.error {
            background-color: #dc3545;
        }

        .toast.warning {
            background-color: #ffc107;
            color: #333;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }
            
            .nav-links {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">LocumTrueRate</a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="paycheck-calculator.html">Paycheck Calculator</a></li>
                <li><a href="contract-calculator.html">Contract Calculator</a></li>
                <li><a href="job-board.html">Job Board</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <div class="calculator-container">
            <h1>Paycheck Calculator</h1>
            
            <!-- Period Selection -->
            <div class="period-tabs">
                <button class="period-tab active" data-period="weekly">Weekly</button>
                <button class="period-tab" data-period="biweekly">Biweekly</button>
                <button class="period-tab" data-period="monthly">Monthly</button>
            </div>

            <div class="calculator-grid">
                <!-- Input Section -->
                <div class="input-section">
                    <h2 class="section-title">Earnings Input</h2>
                    
                    <div class="form-group">
                        <label for="regularHours">Regular Hours</label>
                        <input type="number" id="regularHours" value="40" min="0" max="168" step="0.01">
                        <div class="error-message" id="regularHours-error"></div>
                    </div>

                    <div class="form-group">
                        <label for="regularRate">Regular Rate ($/hr)</label>
                        <input type="number" id="regularRate" value="85.00" min="0" step="0.01">
                        <div class="error-message" id="regularRate-error"></div>
                    </div>

                    <div class="form-group">
                        <label for="overtimeHours">Overtime Hours</label>
                        <input type="number" id="overtimeHours" value="8" min="0" max="168" step="0.01">
                        <div class="error-message" id="overtimeHours-error"></div>
                    </div>

                    <div class="form-group">
                        <label for="overtimeRate">Overtime Rate ($/hr)</label>
                        <input type="number" id="overtimeRate" value="127.50" min="0" step="0.01">
                        <div class="error-message" id="overtimeRate-error"></div>
                    </div>

                    <div class="form-group">
                        <label for="callHours">Call Hours</label>
                        <input type="number" id="callHours" value="0" min="0" step="0.01">
                    </div>

                    <div class="form-group">
                        <label for="callRate">Call Rate ($/hr)</label>
                        <input type="number" id="callRate" value="25.00" min="0" step="0.01">
                    </div>

                    <div class="form-group">
                        <label for="callbackHours">Callback Hours</label>
                        <input type="number" id="callbackHours" value="0" min="0" step="0.01">
                    </div>

                    <div class="form-group">
                        <label for="callbackRate">Callback Rate ($/hr)</label>
                        <input type="number" id="callbackRate" value="127.50" min="0" step="0.01">
                    </div>

                    <h3 class="section-title" style="margin-top: 1.5rem;">Stipends</h3>

                    <div class="form-group">
                        <label for="housingStipend">Housing Stipend</label>
                        <input type="number" id="housingStipend" value="1200" min="0" step="0.01">
                    </div>

                    <div class="form-group">
                        <label for="mealStipend">Meal Stipend</label>
                        <input type="number" id="mealStipend" value="300" min="0" step="0.01">
                    </div>

                    <div class="form-group">
                        <label for="mileageReimbursement">Mileage Reimbursement</label>
                        <input type="number" id="mileageReimbursement" value="150" min="0" step="0.01">
                    </div>

                    <h3 class="section-title" style="margin-top: 1.5rem;">Tax Settings</h3>

                    <div class="form-group">
                        <label for="taxState">Tax State</label>
                        <select id="taxState">
                            <option value="no-tax">No State Tax</option>
                            <option value="ca">California (9.3%)</option>
                            <option value="ny">New York (6.85%)</option>
                            <option value="tx">Texas (0%)</option>
                            <option value="fl">Florida (0%)</option>
                            <option value="wa">Washington (0%)</option>
                            <option value="custom">Custom Rate</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="filingStatus">Filing Status</label>
                        <select id="filingStatus">
                            <option value="single">Single</option>
                            <option value="married">Married Filing Jointly</option>
                            <option value="married-separate">Married Filing Separately</option>
                            <option value="head">Head of Household</option>
                        </select>
                    </div>
                </div>

                <!-- Results Section -->
                <div class="results-section">
                    <h2 class="section-title">Paycheck Breakdown</h2>
                    
                    <div class="result-item">
                        <span class="result-label">Regular Pay:</span>
                        <span class="result-value" id="regularPay">$0.00</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Overtime Pay:</span>
                        <span class="result-value" id="overtimePay">$0.00</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Call Pay:</span>
                        <span class="result-value" id="callPay">$0.00</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Callback Pay:</span>
                        <span class="result-value" id="callbackPay">$0.00</span>
                    </div>
                    
                    <div class="result-item result-total">
                        <span class="result-label">Total Gross Pay:</span>
                        <span class="result-value" id="totalGrossPay">$0.00</span>
                    </div>

                    <h3 class="section-title" style="margin-top: 1.5rem;">Stipends (Non-Taxable)</h3>
                    
                    <div class="result-item">
                        <span class="result-label">Housing:</span>
                        <span class="result-value" id="housingStipendDisplay">$0.00</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Meals:</span>
                        <span class="result-value" id="mealStipendDisplay">$0.00</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Mileage:</span>
                        <span class="result-value" id="mileageDisplay">$0.00</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">Total Stipends:</span>
                        <span class="result-value" id="totalStipends">$0.00</span>
                    </div>

                    <h3 class="section-title" style="margin-top: 1.5rem;">Deductions</h3>
                    
                    <div class="result-item">
                        <span class="result-label">Federal Tax:</span>
                        <span class="result-value" id="federalTax">$0.00</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">State Tax:</span>
                        <span class="result-value" id="stateTax">$0.00</span>
                    </div>
                    
                    <div class="result-item">
                        <span class="result-label">FICA (7.65%):</span>
                        <span class="result-value" id="ficaTax">$0.00</span>
                    </div>
                    
                    <div class="result-item result-total">
                        <span class="result-label">Net Pay:</span>
                        <span class="result-value" id="netPay">$0.00</span>
                    </div>

                    <div class="button-group">
                        <button class="btn btn-primary" id="saveBtn">Save Calculation</button>
                        <button class="btn btn-secondary" id="printBtn">[PRINT] Print Results</button>
                        <button class="btn btn-secondary" id="exportBtn">Export PDF</button>
                        <button class="btn btn-secondary" id="emailBtn">[EMAIL] Email Results</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State variables
        let currentPeriod = 'weekly';
        const periodMultipliers = {
            'weekly': 1,
            'biweekly': 2,
            'monthly': 4.33
        };

        // State tax rates
        const stateTaxRates = {
            'no-tax': 0,
            'ca': 0.093,
            'ny': 0.0685,
            'tx': 0,
            'fl': 0,
            'wa': 0,
            'custom': 0.05
        };

        // Toast notification function
        function showToast(message, type = 'success') {
            // Remove any existing toasts
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }

            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease-out reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }

        // Validate input
        function validateInput(input) {
            const value = parseFloat(input.value);
            const errorElement = document.getElementById(input.id + '-error');
            
            if (errorElement) {
                errorElement.classList.remove('show');
                errorElement.textContent = '';
            }

            // Check for negative values
            if (value < 0) {
                if (errorElement) {
                    errorElement.textContent = 'Value cannot be negative';
                    errorElement.classList.add('show');
                }
                input.value = 0;
                return 0;
            }

            // Check for extreme values
            if (input.id.includes('Hours') && value > 168) {
                if (errorElement) {
                    errorElement.textContent = 'Hours cannot exceed 168 per week';
                    errorElement.classList.add('show');
                }
                input.value = 168;
                return 168;
            }

            if (value > 999999) {
                if (errorElement) {
                    errorElement.textContent = 'Value too large';
                    errorElement.classList.add('show');
                }
                input.value = 999999;
                return 999999;
            }

            return value;
        }

        // Calculate paycheck
        function calculatePaycheck() {
            console.log('Calculating paycheck...');
            
            // Get and validate inputs
            const regularHours = validateInput(document.getElementById('regularHours'));
            const regularRate = validateInput(document.getElementById('regularRate'));
            const overtimeHours = validateInput(document.getElementById('overtimeHours'));
            const overtimeRate = validateInput(document.getElementById('overtimeRate'));
            const callHours = validateInput(document.getElementById('callHours'));
            const callRate = validateInput(document.getElementById('callRate'));
            const callbackHours = validateInput(document.getElementById('callbackHours'));
            const callbackRate = validateInput(document.getElementById('callbackRate'));
            const housingStipend = validateInput(document.getElementById('housingStipend'));
            const mealStipend = validateInput(document.getElementById('mealStipend'));
            const mileageReimbursement = validateInput(document.getElementById('mileageReimbursement'));

            // Get multiplier for period
            const multiplier = periodMultipliers[currentPeriod];

            // Calculate pay components
            const regularPay = regularHours * regularRate * multiplier;
            const overtimePay = overtimeHours * overtimeRate * multiplier;
            const callPay = callHours * callRate * multiplier;
            const callbackPay = callbackHours * callbackRate * multiplier;
            const totalGrossPay = regularPay + overtimePay + callPay + callbackPay;

            // Calculate stipends (already in period amounts)
            const totalStipends = housingStipend + mealStipend + mileageReimbursement;

            // Calculate taxes
            const ficaTax = totalGrossPay * 0.0765;
            const federalTax = calculateFederalTax(totalGrossPay);
            const selectedState = document.getElementById('taxState').value;
            const stateTaxRate = stateTaxRates[selectedState];
            const stateTax = totalGrossPay * stateTaxRate;

            const totalDeductions = federalTax + stateTax + ficaTax;
            const netPay = totalGrossPay - totalDeductions + totalStipends;

            // Update display
            document.getElementById('regularPay').textContent = formatCurrency(regularPay);
            document.getElementById('overtimePay').textContent = formatCurrency(overtimePay);
            document.getElementById('callPay').textContent = formatCurrency(callPay);
            document.getElementById('callbackPay').textContent = formatCurrency(callbackPay);
            document.getElementById('totalGrossPay').textContent = formatCurrency(totalGrossPay);
            
            document.getElementById('housingStipendDisplay').textContent = formatCurrency(housingStipend);
            document.getElementById('mealStipendDisplay').textContent = formatCurrency(mealStipend);
            document.getElementById('mileageDisplay').textContent = formatCurrency(mileageReimbursement);
            document.getElementById('totalStipends').textContent = formatCurrency(totalStipends);
            
            document.getElementById('federalTax').textContent = formatCurrency(federalTax);
            document.getElementById('stateTax').textContent = formatCurrency(stateTax);
            document.getElementById('ficaTax').textContent = formatCurrency(ficaTax);
            document.getElementById('netPay').textContent = formatCurrency(netPay);
        }

        // Simple federal tax calculation
        function calculateFederalTax(grossPay) {
            // Simplified federal tax calculation
            const annualizedGross = grossPay * 52 / periodMultipliers[currentPeriod];
            let tax = 0;

            if (annualizedGross > 539900) {
                tax = 162718 + (annualizedGross - 539900) * 0.37;
            } else if (annualizedGross > 215950) {
                tax = 49335 + (annualizedGross - 215950) * 0.35;
            } else if (annualizedGross > 170050) {
                tax = 33271 + (annualizedGross - 170050) * 0.32;
            } else if (annualizedGross > 89075) {
                tax = 15213 + (annualizedGross - 89075) * 0.28;
            } else if (annualizedGross > 41775) {
                tax = 4807 + (annualizedGross - 41775) * 0.22;
            } else if (annualizedGross > 10275) {
                tax = 1027 + (annualizedGross - 10275) * 0.12;
            } else {
                tax = annualizedGross * 0.10;
            }

            // Convert back to period amount
            return tax * periodMultipliers[currentPeriod] / 52;
        }

        // Set period
        function setPeriod(period) {
            currentPeriod = period;
            
            // Update active tab
            document.querySelectorAll('.period-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.dataset.period === period) {
                    tab.classList.add('active');
                }
            });
            
            // Recalculate
            calculatePaycheck();
        }

        // Save calculation
        function saveCalculation() {
            const data = {
                period: currentPeriod,
                regularHours: document.getElementById('regularHours').value,
                regularRate: document.getElementById('regularRate').value,
                overtimeHours: document.getElementById('overtimeHours').value,
                overtimeRate: document.getElementById('overtimeRate').value,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('paycheckCalculation', JSON.stringify(data));
            showToast('Calculation saved successfully!', 'success');
        }

        // Print results
        function printResults() {
            window.print();
            showToast('[PRINT] Print dialog opened', 'success');
        }

        // Export to PDF
        function exportToPDF() {
            // Create text content
            const content = `Paycheck Analysis - ${currentPeriod}
            
Regular Pay: ${document.getElementById('regularPay').textContent}
Overtime Pay: ${document.getElementById('overtimePay').textContent}
Total Gross Pay: ${document.getElementById('totalGrossPay').textContent}
Net Pay: ${document.getElementById('netPay').textContent}

Generated: ${new Date().toLocaleDateString()}`;
            
            // Create blob and download
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `paycheck-analysis-${currentPeriod}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('Paycheck summary downloaded!', 'success');
        }

        // Email results
        function emailResults() {
            const subject = `Paycheck Analysis - ${currentPeriod}`;
            const body = `Paycheck Analysis Summary:

Period: ${currentPeriod}

EARNINGS:
Regular Pay: ${document.getElementById('regularPay').textContent}
Overtime Pay: ${document.getElementById('overtimePay').textContent}
Total Gross Pay: ${document.getElementById('totalGrossPay').textContent}

DEDUCTIONS:
Federal Tax: ${document.getElementById('federalTax').textContent}
State Tax: ${document.getElementById('stateTax').textContent}
FICA Tax: ${document.getElementById('ficaTax').textContent}

NET PAY: ${document.getElementById('netPay').textContent}

Generated: ${new Date().toLocaleDateString()}`;
            
            window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            showToast('[EMAIL] Opening email client...', 'success');
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initializing paycheck calculator...');
            
            // Add event listeners to all inputs
            const inputs = document.querySelectorAll('input[type="number"], select');
            inputs.forEach(input => {
                input.addEventListener('input', calculatePaycheck);
                input.addEventListener('change', calculatePaycheck);
            });

            // Add event listeners to period tabs
            document.querySelectorAll('.period-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    setPeriod(this.dataset.period);
                });
            });

            // Add event listeners to buttons
            document.getElementById('saveBtn').addEventListener('click', saveCalculation);
            document.getElementById('printBtn').addEventListener('click', printResults);
            document.getElementById('exportBtn').addEventListener('click', exportToPDF);
            document.getElementById('emailBtn').addEventListener('click', emailResults);

            // Auto-set overtime rate when regular rate changes
            document.getElementById('regularRate').addEventListener('input', function() {
                const regularRate = parseFloat(this.value) || 0;
                document.getElementById('overtimeRate').value = (regularRate * 1.5).toFixed(2);
            });

            // Run initial calculation
            calculatePaycheck();
            
            console.log('Calculator initialized successfully!');
        });
    </script>
</body>
</html>